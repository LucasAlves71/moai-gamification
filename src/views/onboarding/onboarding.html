<div class="onboarding-container">
    <div class="onboarding-background">
        <!-- Efeito de oceano similar ao da p√°gina de ilhas -->
        <div class="ocean">
            <div class="ocean-wave wave-1"></div>
            <div class="ocean-wave wave-2"></div>
            <div class="ocean-wave wave-3"></div>
        </div>

        <!-- Bolhas decorativas -->
        <div class="bubble bubble-1"></div>
        <div class="bubble bubble-2"></div>
        <div class="bubble bubble-3"></div>
    </div>

    <!-- Modal 1: Boas-vindas -->
    <div class="modal fade show d-block" id="welcomeModal" data-bs-backdrop="static" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content card-moai">
                <div class="modal-body text-center p-5">
                    <img src="public/img/moai-logo.png" alt="MOAI Logo" class="welcome-logo mb-4">
                    <h2 class="welcome-title mb-4">Bem-vindo √† Jornada MOAI!</h2>
                    <p class="welcome-text mb-4">
                        Voc√™ est√° prestes a embarcar em uma jornada de descobertas,
                        desafios e crescimento profissional atrav√©s da nossa experi√™ncia de gamifica√ß√£o.
                    </p>
                    <button class="btn btn-moai-primary btn-lg" ng-click="nextStep()" type="button">
                        Iniciar Jornada
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal 2: Explica√ß√£o da gamifica√ß√£o -->
    <div class="modal fade" id="explanationModal" data-bs-backdrop="static" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content card-moai">
                <div class="modal-body p-5">
                    <div class="row">
                        <div class="col-md-4 mb-3 mb-md-0">
                            <div class="guide-character">
                                <!-- Placeholder para personagem guia (a ser substitu√≠do por PNG) -->
                                <div class="character-placeholder">üßô‚Äç‚ôÇÔ∏è</div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <h2 class="explanation-title mb-3">Como funciona a MOAI</h2>
                            <div class="explanation-text">
                                <p>Na plataforma MOAI voc√™ vai:</p>
                                <ul class="feature-list">
                                    <li><span class="feature-icon">üèùÔ∏è</span> Explorar ilhas tem√°ticas com desafios</li>
                                    <li><span class="feature-icon">‚öíÔ∏è</span> Desenvolver recursos e habilidades</li>
                                    <li><span class="feature-icon">üèÜ</span> Participar de temporadas competitivas</li>
                                    <li><span class="feature-icon">üéÅ</span> Ganhar recompensas e reconhecimento</li>
                                </ul>
                                <p>Tudo isso enquanto evolui profissionalmente!</p>
                            </div>
                            <div class="mt-4 text-end">
                                <button class="btn btn-moai-secondary me-2" ng-click="previousStep()" type="button">Voltar</button>
                                <button class="btn btn-moai-primary" ng-click="nextStep()" type="button">Continuar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal 3: Nome da ilha e foto do perfil -->
    <div class="modal fade" id="islandNameModal" data-bs-backdrop="static" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content card-moai">
                <div class="modal-body p-5">
                    <div class="row">
                        <div class="col-md-4 mb-3 mb-md-0">
                            <div class="island-illustration">
                                <img src="public/img/minha-ilha.png" alt="Sua Ilha" class="img-fluid">
                            </div>
                        </div>
                        <div class="col-md-8">
                            <h2 class="island-name-title mb-3">Personalize sua jornada</h2>
                            <p class="island-name-text mb-4">
                                Esta ser√° a sua base de opera√ß√µes durante toda a jornada.
                                Como voc√™ gostaria de chamar sua ilha?
                            </p>

                            <div class="form-floating mb-4">
                                <input type="text" class="form-control" id="islandNameInput"
                                       ng-model="islandName" placeholder="Nome da ilha">
                                <label for="islandNameInput">Nome da ilha</label>
                            </div>

                            <div class="alert alert-danger" role="alert" ng-show="nameError">
                                Por favor, insira um nome para sua ilha antes de continuar.
                            </div>

                            <!-- Se√ß√£o de foto de perfil -->
                            <h4 class="photo-title mb-3">Adicione sua foto de perfil</h4>
                            <div class="profile-photo-section mb-4">
                                <div class="text-center mb-4">
                                    <div class="profile-photo-container d-inline-block position-relative">
                                        <img ng-src="{{selectedImageUrl || 'public/img/default-avatar.png'}}"
                                             alt="Foto de perfil" class="profile-photo rounded-circle img-fluid">
                                        <div class="photo-edit-btn" ng-click="openFileSelector()">
                                            <span>‚úèÔ∏è</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center mt-3">
                                    <p class="text-muted small">Adicione uma foto para seu perfil MOAI</p>
                                    <input type="file" id="onboarding-photo-input" accept="image/*" class="d-none"
                                           onchange="angular.element(this).scope().handleFileSelect(this)">
                                </div>
                            </div>

                            <div class="mt-4 text-end">
                                <button class="btn btn-moai-secondary me-2" ng-click="previousStep()" type="button">Voltar</button>
                                <button class="btn btn-moai-primary" ng-click="finishOnboarding()" type="button">
                                    <span ng-if="!isProcessing">Come√ßar esse grande legado!</span>
                                    <span ng-if="isProcessing">
                                        <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                                        Processando...
                                    </span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para cropping de imagem -->
    <div class="modal" id="imageCropperModal" style="display: block; background: rgba(0,0,0,0.5); z-index: 1060;" ng-if="showImageCropper">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Recortar Imagem de Perfil</h5>
                    <button type="button" class="btn-close" ng-click="cancelImageUpload()"></button>
                </div>
                <div class="modal-body">
                    <div class="text-center mb-3">
                        <p>Arraste e redimensione para ajustar sua foto de perfil</p>
                    </div>
                    <image-cropper
                        image-source="previewImageUrl"
                        on-crop-complete="uploadProfileImage(imageDataUrl)"
                        on-cancel="cancelImageUpload()">
                    </image-cropper>

                    <!-- Indicador de carregamento simples -->
                    <div class="text-center mt-3" ng-if="isProcessing">
                        <span class="spinner-border text-primary" role="status"></span>
                        <span class="ms-2">Processando imagem...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
